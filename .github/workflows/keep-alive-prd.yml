name: Keep-Alive Backend PRD

on:
  schedule:
    # 00:00-01:00 BRT = 03:00-04:00 UTC (madrugada)
    - cron: "*/4 3 * * *"
    
    # 10:00-23:59 BRT = 13:00-02:59 UTC (manhÃ£/tarde/noite)
    # Parte 1: 10:00-20:00 BRT = 13:00-23:00 UTC
    - cron: "*/4 13-23 * * *"
    
    # Parte 2: 21:00-23:59 BRT = 00:00-02:59 UTC (dia seguinte)
    - cron: "*/4 0-2 * * *"
    
  workflow_dispatch: # Permite executar manualmente

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Backend PRD
        run: |
          echo "ğŸ”„ Pingando Backend PRD..."
          response=$(curl -s -o /dev/null -w "%{http_code}" https://ohana-api-prd.onrender.com/api/ping)
          echo "ğŸ“¡ Status: $response"

          if [ $response -eq 200 ]; then
            echo "âœ… Backend PRD estÃ¡ ativo!"
          else
            echo "âš ï¸ Backend PRD retornou status: $response"
            exit 1
          fi

      - name: Exibir horÃ¡rio
        run: |
          echo "ğŸ• Ping executado em: $(date -u +"%Y-%m-%d %H:%M:%S UTC")"
          echo "ğŸ• HorÃ¡rio Brasil: $(TZ=America/Sao_Paulo date +"%Y-%m-%d %H:%M:%S %Z")"
